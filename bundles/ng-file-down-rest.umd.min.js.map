{"version":3,"sources":["ng://ng-file-down-rest/lib/ng-file-down-rest.service.ts","ng://ng-file-down-rest/lib/ng-file-down-rest.component.ts","ng://ng-file-down-rest/lib/ng-file-down-rest.module.ts"],"names":["NgFileDownRestService","Injectable","args","providedIn","NgFileDownRestComponent","document","this","methodType","fileName","tagName","response","EventEmitter","blobUrl","message","success","prototype","ngOnInit","ngAfterViewInit","styleCss","anchorElement","nativeElement","style","color","handleDownload","event","preventDefault","urlPath","makeApiCall","emit","xhr","XMLHttpRequest","open","headerObject","header","JSON","parse","property","setRequestHeader","responseType","that","onreadystatechange","readyState","contentType","getResponseHeader","blob","Blob","type","makeAmends","dto","params","send","window","URL","createObjectURL","elm","createElement","href","download","body","append","click","remove","revokeObjectURL","ngOnDestroy","Component","selector","template","Inject","DOCUMENT","Input","Output","ViewChild","static","NgFileDownRestModule","NgModule","declarations","imports","exports"],"mappings":"sVAAA,IAAAA,EAAA,WAOE,SAAAA,gCALDC,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,wJAHd,GCAAC,EAAA,WAyBE,SAAAA,EAAsCC,GAAAC,KAAAD,SAAAA,EAhB7BC,KAAAC,WAAqB,MACrBD,KAAAE,SAAmB,SAGnBF,KAAAG,QAAkB,WAEjBH,KAAAI,SAAW,IAAIC,EAAAA,aAEzBL,KAAAM,QAAU,GACVN,KAAAO,QAAU,CAACC,SAAW,GAkFxB,OA/EEV,EAAAW,UAAAC,SAAA,aAMAZ,EAAAW,UAAAE,gBAAA,WACOX,KAAKY,SAGRZ,KAAKa,cAAcC,cAAcC,MAAQf,KAAKY,SAF9CZ,KAAKa,cAAcC,cAAcC,MAAMC,MAAQ,WAKnDlB,EAAAW,UAAAQ,eAAA,SAAeC,GACW,SAApBlB,KAAKC,YACPiB,EAAMC,iBACFnB,KAAKoB,SACPpB,KAAKqB,eAGPrB,KAAKI,SAASkB,KAAKtB,KAAKO,UAI5BT,EAAAW,UAAAY,YAAA,eACME,EAAM,IAAIC,eACdD,EAAIE,KAAK,OAAQzB,KAAKoB,aAClBM,EAAe,GAInB,GAHI1B,KAAK2B,SACPD,EAAeE,KAAKC,MAAM7B,KAAK2B,SAE7BD,EACF,IAAK,IAAMI,KAAYJ,EACrBH,EAAIQ,iBAAiB,GAAGD,EAAY,GAAGJ,EAAaI,SAGtDP,EAAIQ,iBAAiB,eAAgB,oBACrCR,EAAIQ,iBAAiB,gBAAiB,YAExCR,EAAIS,aAAe,WACfC,EAAOjC,KACXuB,EAAIW,mBAAkB,WACpB,GAAwB,IAApBlC,KAAKmC,WAAkB,KACrBC,EAAcb,EAAIc,kBAAkB,gBAAkBd,EAAIc,kBAAkB,gBAAkB,aAClG,GAAID,EAAa,KACXE,EAAO,IAAIC,KAAK,CAACvC,KAAKI,UAAW,CAACoC,KAAMJ,IAC5CH,EAAKQ,WAAWH,EAAML,UAIxBS,EAAM1C,KAAK2C,OACXD,GACFnB,EAAIqB,KAAKF,IAIb5C,EAAAW,UAAAgC,WAAA,SAAWH,EAAML,GACfA,EAAK3B,QAAUuC,OAAOC,IAAIC,gBAAgBT,OACtCU,EAAMjD,SAASkD,cAAc,KACjCD,EAAIE,KAAOjB,EAAK3B,QAChB0C,EAAIG,SAAWnD,KAAKE,SACpBH,SAASqD,KAAKC,OAAOL,GACrBA,EAAIM,QACJN,EAAIO,SACJV,OAAOC,IAAIU,gBAAgBvB,EAAK3B,SAChCN,KAAKI,SAASkB,KAAKtB,KAAKO,UAG1BT,EAAAW,UAAAgD,YAAA,WACEzD,KAAKoB,QAAU,GACfpB,KAAKC,WAAa,MAClBD,KAAK2C,OAAS,GACd3C,KAAK2B,OAAS,GACd3B,KAAKE,SAAW,SAChBF,KAAKG,QAAU,WACfH,KAAKY,SAAW,GAChBZ,KAAKM,QAAU,GACfN,KAAKO,QAAU,CAACC,SAAW,wBAhG9BkD,EAAAA,UAAS9D,KAAA,CAAC,CACT+D,SAAU,oBACVC,SAAA,kKAqBaC,EAAAA,OAAMjE,KAAA,CAACkE,EAAAA,gDAjBnBC,EAAAA,0BACAA,EAAAA,wBACAA,EAAAA,sBACAA,EAAAA,sBACAA,EAAAA,uBACAA,EAAAA,wBACAA,EAAAA,wBACAC,EAAAA,8BACAC,EAAAA,UAASrE,KAAA,CAAC,iBAAkB,CAACsE,QAAQ,OAoFxCpE,EApGA,GCAA,IAAAqE,EAAA,WAKA,SAAAA,KAMoC,2BANnCC,EAAAA,SAAQxE,KAAA,CAAC,CACRyE,aAAc,CAACvE,GACfwE,QAAS,GAETC,QAAS,CAACzE,OAEwBqE,EAXpC","sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NgFileDownRestService {\n\n  constructor() { }\n}\n","import { Component, OnInit, AfterViewInit, OnDestroy, Input, EventEmitter, Output, ElementRef, ViewChild, Inject} from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\n@Component({\n  selector: 'ng-file-down-rest',\n  templateUrl: './ng-file-down-rest.component.html',\n  styleUrls: []\n})\nexport class NgFileDownRestComponent implements OnInit, AfterViewInit, OnDestroy  {\n  @Input() urlPath: string;\n  @Input() methodType: string = 'GET';\n  @Input() fileName: string = 'myFile';\n  @Input() params: any;\n  @Input() header: any;\n  @Input() tagName: string = 'Download';\n  @Input() styleCss: string;\n  @Output() response = new EventEmitter<any>();\n  @ViewChild('ngFileLinkRest', {static: false}) anchorElement: ElementRef;\n  blobUrl = '';\n  message = {\"success\": true};\n\n\n  ngOnInit() {\n\n  }\n\n  constructor(@Inject(DOCUMENT) private document) { }\n\n  ngAfterViewInit() {\n    if (!this.styleCss) {\n      this.anchorElement.nativeElement.style.color = '#6475FF';\n    } else {\n      this.anchorElement.nativeElement.style = this.styleCss;\n    }\n  }\n  handleDownload(event) {\n    if (this.methodType === \"POST\") {\n      event.preventDefault();\n      if (this.urlPath) {\n        this.makeApiCall();\n      }\n    } else {\n      this.response.emit(this.message);\n    }\n  }\n\n  makeApiCall() {\n    let xhr = new XMLHttpRequest();\n    xhr.open('POST', this.urlPath);\n    let headerObject = {}\n    if (this.header) {\n      headerObject = JSON.parse(this.header);\n    }\n    if (headerObject) {\n      for (const property in headerObject) {\n        xhr.setRequestHeader(`${property}`, `${headerObject[property]}`);\n      }\n    } else {\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n      xhr.setRequestHeader(\"cache-control\", \"no-cache\");\n    }\n    xhr.responseType = 'blob';\n    let that = this;\n    xhr.onreadystatechange = function() {\n      if (this.readyState === 4) {\n        let contentType = xhr.getResponseHeader(\"Content-Type\") ? xhr.getResponseHeader(\"Content-Type\") : 'text/plain';\n        if (contentType) {\n          let blob = new Blob([this.response], {type: contentType});\n          that.makeAmends(blob, that);\n        }\n      }\n    }\n    let dto = this.params;\n    if (dto) {\n      xhr.send(dto);\n    }\n  }\n\n  makeAmends(blob, that) {\n    that.blobUrl = window.URL.createObjectURL(blob);\n    let elm = document.createElement('a');\n    elm.href = that.blobUrl;\n    elm.download = this.fileName;\n    document.body.append(elm);\n    elm.click();\n    elm.remove();\n    window.URL.revokeObjectURL(that.blobUrl);\n    this.response.emit(this.message);\n  }\n\n  ngOnDestroy() {\n    this.urlPath = '';\n    this.methodType = 'GET';\n    this.params = '';\n    this.header = {};\n    this.fileName = 'myFile';\n    this.tagName = 'Download';\n    this.styleCss = '';\n    this.blobUrl = '';\n    this.message = {\"success\": true};\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { NgFileDownRestComponent } from './ng-file-down-rest.component';\n\n\n\n@NgModule({\n  declarations: [NgFileDownRestComponent],\n  imports: [\n  ],\n  exports: [NgFileDownRestComponent]\n})\nexport class NgFileDownRestModule { }\n"]}