{"version":3,"file":"ng-file-down-rest.umd.js","sources":["ng://ng-file-down-rest/lib/ng-file-down-rest.service.ts","ng://ng-file-down-rest/lib/ng-file-down-rest.component.ts","ng://ng-file-down-rest/lib/ng-file-down-rest.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NgFileDownRestService {\n\n  constructor() { }\n}\n","import { Component, OnInit, AfterViewInit, OnDestroy, Input, EventEmitter, Output, ElementRef, ViewChild, Inject} from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\n@Component({\n  selector: 'ng-file-down-rest',\n  templateUrl: './ng-file-down-rest.component.html',\n  styleUrls: []\n})\nexport class NgFileDownRestComponent implements OnInit, AfterViewInit, OnDestroy  {\n  @Input() urlPath: string;\n  @Input() methodType: string = 'GET';\n  @Input() params: any;\n  @Input() header: any;\n  @Input() tagName: string = 'Download';\n  @Input() styleCss: string;\n  @Output() response = new EventEmitter<any>();\n  @ViewChild('ngFileLinkRest', {static: false}) anchorElement: ElementRef;\n  blobUrl = '';\n  message = {\"success\": true};\n\n\n  ngOnInit() {\n\n  }\n\n  constructor(@Inject(DOCUMENT) private document) { }\n\n  ngAfterViewInit() {\n    if (!this.styleCss) {\n      this.anchorElement.nativeElement.style.color = '#6475FF';\n    } else {\n      this.anchorElement.nativeElement.style = this.styleCss;\n    }\n  }\n  handleDownload(event) {\n    if (this.methodType === \"POST\") {\n      event.preventDefault();\n      if (this.urlPath) {\n        this.makeApiCall();\n      }\n    } else {\n      this.response.emit(this.message);\n    }\n  }\n\n  makeApiCall() {\n    let xhr = new XMLHttpRequest();\n    xhr.open('POST', this.urlPath);\n    let headerObject = {}\n    if (this.header) {\n      headerObject = JSON.parse(this.header);\n    }\n    if (headerObject) {\n      for (const property in headerObject) {\n        xhr.setRequestHeader(`${property}`, `${headerObject[property]}`);\n      }\n    } else {\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n      xhr.setRequestHeader(\"cache-control\", \"no-cache\");\n    }\n    xhr.responseType = 'blob';\n    let that = this;\n    xhr.onreadystatechange = function() {\n      if (this.readyState === 4) {\n        let contentType = xhr.getResponseHeader(\"Content-Type\") ? xhr.getResponseHeader(\"Content-Type\") : 'text/plain';\n        if (contentType) {\n          let blob = new Blob([this.response], {type: contentType});\n          that.makeAmends(blob, that);\n        }\n      }\n    }\n    let dto = this.params;\n    if (dto) {\n      xhr.send(dto);\n    }\n  }\n\n  makeAmends(blob, that) {\n    that.blobUrl = window.URL.createObjectURL(blob);\n    window.open(that.blobUrl);\n    this.response.emit(this.message);\n  }\n\n  ngOnDestroy() {\n    window.URL.revokeObjectURL(this.blobUrl);\n    this.urlPath = '';\n    this.methodType = 'GET';\n    this.params = '';\n    this.header = {};\n    this.tagName = 'Download';\n    this.styleCss = '';\n    this.blobUrl = '';\n    this.message = {\"success\": true};\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { NgFileDownRestComponent } from './ng-file-down-rest.component';\n\n\n\n@NgModule({\n  declarations: [NgFileDownRestComponent],\n  imports: [\n  ],\n  exports: [NgFileDownRestComponent]\n})\nexport class NgFileDownRestModule { }\n"],"names":["Injectable","EventEmitter","Component","Inject","DOCUMENT","Input","Output","ViewChild","NgModule"],"mappings":"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"}